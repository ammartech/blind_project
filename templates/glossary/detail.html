{% extends 'base.html' %}
{% block title %}{{ term.term }} | ูุงููุณ ุงููุตุทูุญุงุช{% endblock %}

{% block content %}

<div class="page-head">
  <nav class="breadcrumb" aria-label="ุงูุชููู">
    <a href="{% url 'glossary:list' %}">ูุงููุณ ุงููุตุทูุญุงุช</a>
    <span class="separator">></span>
    <span>{{ term.term }}</span>
  </nav>

  <h1 class="term-title">{{ term.term }}</h1>

  {% if term.pronunciation_hint %}
    <p class="pronunciation-hint">
      <span class="label">ุชูููุญ ุงููุทู:</span>
      <strong>{{ term.pronunciation_hint }}</strong>
    </p>
  {% endif %}

  {% if term.category %}
    <span class="term-badge">{% if term.category.icon %}{{ term.category.icon }} {% endif %}{{ term.category.name }}</span>
  {% endif %}
</div>

<!-- Definition Card -->
<div class="card">
  <h2>ุงูุชุนุฑูู</h2>
  <p class="para definition-text">
    {{ term.definition|linebreaksbr }}
  </p>
</div>

<!-- TTS Card -->
<div class="card tts-card">
  <h3>๐ ุงููุฑุงุกุฉ ุงูุตูุชูุฉ</h3>

  <div class="tts-settings">
    <!-- Engine toggle -->
    <div class="tts-setting-group">
      <span class="tts-setting-label">ูุญุฑู ุงููุฑุงุกุฉ:</span>
      <div class="engine-selector" role="radiogroup" aria-label="ุงุฎุชูุงุฑ ูุญุฑู ุงููุฑุงุกุฉ">
        <label class="engine-option selected">
          <input type="radio" name="tts-engine" value="ai" checked>
          <span>๐ค ุฐูุงุก ุงุตุทูุงุนู</span>
        </label>
        <label class="engine-option">
          <input type="radio" name="tts-engine" value="browser">
          <span>๐ ูุญุฑู ุงููุชุตูุญ</span>
        </label>
      </div>
    </div>

    <!-- Voice selector -->
    <div class="tts-setting-group">
      <span class="tts-setting-label">ุงูุตูุช:</span>
      <div class="voice-selector" role="radiogroup" aria-label="ุงุฎุชูุงุฑ ุงูุตูุช">
        <label class="voice-option selected">
          <input type="radio" name="tts-voice" value="female" checked>
          <span>๐ฉ ุฃูุซู</span>
        </label>
        <label class="voice-option">
          <input type="radio" name="tts-voice" value="male">
          <span>๐จ ุฐูุฑ</span>
        </label>
      </div>
    </div>

    <!-- Speed selector -->
    <div class="tts-setting-group">
      <span class="tts-setting-label">ุงูุณุฑุนุฉ:</span>
      <div class="speed-selector" role="radiogroup" aria-label="ุงุฎุชูุงุฑ ุงูุณุฑุนุฉ">
        <label class="speed-option">
          <input type="radio" name="tts-speed" value="slow">
          <span>๐ข ุจุทูุก</span>
        </label>
        <label class="speed-option selected">
          <input type="radio" name="tts-speed" value="normal" checked>
          <span>โถ ุนุงุฏู</span>
        </label>
        <label class="speed-option">
          <input type="radio" name="tts-speed" value="fast">
          <span>โก ุณุฑูุน</span>
        </label>
      </div>
    </div>
  </div>

  <!-- TTS Buttons Row -->
  <div class="tts-actions">
    <button class="tts-btn large" type="button"
            onclick="playGlossaryTTS({{ term.pk }}, 'full')"
            aria-label="ูุฑุงุกุฉ ุงููุตุทูุญ ูุงูุชุนุฑูู ูุนุงู">
      ๐ ูุฑุงุกุฉ ุงููุตุทูุญ ูุงูุชุนุฑูู
    </button>

    <button class="tts-btn" type="button"
            onclick="playGlossaryTTS({{ term.pk }}, 'term')"
            aria-label="ูุฑุงุกุฉ ุงููุตุทูุญ ููุท">
      ๐ ุงููุตุทูุญ ููุท
    </button>

    <button class="tts-btn" type="button"
            onclick="playGlossaryTTS({{ term.pk }}, 'definition')"
            aria-label="ูุฑุงุกุฉ ุงูุชุนุฑูู ููุท">
      ๐ ุงูุชุนุฑูู ููุท
    </button>

    <button class="tts-btn danger" type="button"
            onclick="stopTTS()"
            aria-label="ุฅููุงู ุงููุฑุงุกุฉ">
      โน ุฅููุงู
    </button>
  </div>

  <p class="hint">ุงุฎุชุฑ ุงููุญุฑู ูุงูุตูุช ูุงูุณุฑุนุฉ ุซู ุงุถุบุท ุนูู ุฒุฑ ุงููุฑุงุกุฉ.</p>
</div>

<!-- Stats Card -->
<div class="card stats-card">
  <div class="term-stats">
    <span>๐ ุงููุดุงูุฏุงุช: <strong>{{ term.view_count }}</strong></span>
    <span>๐ ูุฑุงุช ุงูุชุดุบูู: <strong id="tts-play-count">{{ term.tts_play_count }}</strong></span>
    <span>๐ ุฃุถูู: <strong>{{ term.created_at|date:"Y/m/d" }}</strong></span>
  </div>
</div>

<!-- Actions -->
<div class="back-link">
  <a class="btn outline" href="{% url 'glossary:list' %}">โ ุงูุนูุฏุฉ ููุงููุณ ุงููุตุทูุญุงุช</a>
  {% if user.is_authenticated and user.is_librarian %}
    <a class="btn secondary" href="{% url 'service:glossary_edit' term.pk %}">ุชุนุฏูู</a>
  {% endif %}
</div>

{% endblock %}
