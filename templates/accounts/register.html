{% extends 'base.html' %}
{% block title %}ุฅูุดุงุก ุญุณุงุจ | ููุตุฉ ุทูุจุฉ ุงูุตูุชูุฉ{% endblock %}

{% block content %}
<div class="auth">
  <!-- Visual Side -->
  <div class="auth-visual">
    <div class="auth-visual-content">
      <div class="auth-logo">
        <span class="auth-logo-dot"></span>
        ุทูุจุฉ
      </div>
      <h2>ุงูุถู ุฅูู ููุตุฉ ุทูุจุฉ ุงูุตูุชูุฉ</h2>
      <p>ููุตุฉ ูุชุฎุตุตุฉ ูุฎุฏูุฉ ุงูููููููู ูู ุงููุตูู ุฅูู ูุตุงุฏุฑ ุงููุนูููุงุช ูุงูููุชุจุงุช.</p>

      <div class="auth-feature">
        <span class="auth-feature-icon">๐ฏ</span>
        <div class="auth-feature-text">
          <strong>ุณูููุฉ ุงูุชุณุฌูู</strong>
          <span>ุณุฌูู ุจุงููุนูููุงุช ุงูุฃุณุงุณูุฉ ูุฃููู ูููู ูุงุญูุงู</span>
        </div>
      </div>

      <div class="auth-feature">
        <span class="auth-feature-icon">๐</span>
        <div class="auth-feature-text">
          <strong>ุฏุนู ุตูุชู ูุงูู</strong>
          <span>ูุฑุงุกุฉ ุตูุชูุฉ ูุฌููุน ุงููุญุชููุงุช</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Form Side -->
  <div class="auth-form-container">
    <div class="auth-card">
      <h1>ุฅูุดุงุก ุญุณุงุจ ุฌุฏูุฏ</h1>
      <span class="muted">ุงูุญููู ุงููููุฒุฉ ุจู (*) ูุทููุจุฉุ ูุงูุจุงูู ููููู ุฅููุงูู ูุงุญูุงู.</span>

      <form method="post" class="form">
        {% csrf_token %}

        {# Errors summary #}
        {% if form.errors %}
          <div class="card" style="margin-top:12px">
            <strong>ุชุนุฐุฑ ุฅูุดุงุก ุงูุญุณุงุจ.</strong>
            <div class="hint">ูุฑุฌู ูุฑุงุฌุนุฉ ุงูุฃุฎุทุงุก ุงูุธุงูุฑุฉ ุจุงูุฃุณูู ูุชุตุญูุญูุง.</div>
            {{ form.non_field_errors }}
          </div>
        {% else %}
          {{ form.non_field_errors }}
        {% endif %}

        <!-- Required Section -->
        <div class="form-section">
          <h3 class="section-title">ุงููุนูููุงุช ุงูุฃุณุงุณูุฉ (ูุทููุจุฉ)</h3>

          <div class="form-row">
            <label for="{{ form.username.id_for_label }}">{{ form.username.label }}</label>
            {{ form.username }}
            {{ form.username.errors }}
          </div>

          <div class="form-row">
            <label for="{{ form.email.id_for_label }}">{{ form.email.label }}</label>
            {{ form.email }}
            {{ form.email.errors }}
          </div>

          <div class="form-row">
            <label for="{{ form.password1.id_for_label }}">{{ form.password1.label }}</label>
            {{ form.password1 }}
            {{ form.password1.errors }}
          </div>

          <div class="form-row">
            <label for="{{ form.password2.id_for_label }}">{{ form.password2.label }}</label>
            {{ form.password2 }}
            {{ form.password2.errors }}
          </div>

          {# โ FIX: role instead of user_type #}
          <div class="form-row">
            <label for="{{ form.role.id_for_label }}">{{ form.role.label }}</label>
            {{ form.role }}
            {{ form.role.errors }}
            <p class="field-hint">
              ุงุฎุชุฑ "ูุณุชููุฏ (ููููู)" ุฅุฐุง ููุช ูู ุฐูู ุงูุฅุนุงูุฉ ุงูุจุตุฑูุฉุ
              ุฃู "ุฃุฎุตุงุฆู ููุชุจุฉ" ุฅุฐุง ููุช ุชุนูู ูู ุงูููุชุจุฉ.
            </p>
          </div>
        </div>

        <!-- Optional Section (Collapsible) -->
        <div class="form-section optional-section">
          <button type="button" class="section-toggle" onclick="toggleOptional()">
            <span class="toggle-icon" id="toggle-icon">โผ</span>
            ูุนูููุงุช ุฅุถุงููุฉ (ุงุฎุชูุงุฑู - ููููู ุชุฎุทููุง)
          </button>

          <div class="optional-fields" id="optional-fields">
            <p class="field-hint">ูุฐู ุงููุนูููุงุช ุชุณุงุนุฏูุง ูู ุชูุฏูู ุฎุฏูุฉ ุฃูุถู. ููููู ุฅุถุงูุชูุง ุงูุขู ุฃู ูุงุญูุงู ูู ุตูุญุฉ ุงูููู ุงูุดุฎุตู.</p>

            <div class="form-row">
              <label for="{{ form.full_name_ar.id_for_label }}">{{ form.full_name_ar.label }}</label>
              {{ form.full_name_ar }}
              {{ form.full_name_ar.errors }}
            </div>

            <div class="form-grid-2">
              <div class="form-row">
                <label for="{{ form.gender.id_for_label }}">{{ form.gender.label }}</label>
                {{ form.gender }}
                {{ form.gender.errors }}
              </div>

              <div class="form-row">
                <label for="{{ form.birth_date.id_for_label }}">{{ form.birth_date.label }}</label>
                {{ form.birth_date }}
                {{ form.birth_date.errors }}
              </div>
            </div>

            <div class="form-row">
              <label for="{{ form.phone.id_for_label }}">{{ form.phone.label }}</label>
              {{ form.phone }}
              {{ form.phone.errors }}
            </div>
          </div>
        </div>

        <button class="btn primary w-full" type="submit">ุฅูุดุงุก ุงูุญุณุงุจ</button>
      </form>

      <div class="auth-footer">
        ูุฏูู ุญุณุงุจ ุจุงููุนูุ <a href="{% url 'accounts:login' %}">ุชุณุฌูู ุงูุฏุฎูู</a>
      </div>
    </div>
  </div>
</div>

<script>
function toggleOptional() {
  const fields = document.getElementById('optional-fields');
  const icon = document.getElementById('toggle-icon');

  if (fields.classList.contains('show')) {
    fields.classList.remove('show');
    icon.textContent = 'โผ';
  } else {
    fields.classList.add('show');
    icon.textContent = 'โฒ';
  }
}
</script>
{% endblock %}
